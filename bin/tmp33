#!/usr/bin/env python

"""
Uploads files to 33ad/tmp via the command line.

USAGE
=====
tmp33 file1 file2 ...

CONFIGURATION
=============
The script will first look for an environment variable TMP33 containing the
upload password. If that doesn't exist, the password will be requested via
prompt.
"""

from lib33 import upload_file
from lib33 import blinkto

usage = __doc__

def main():
    from os import environ
    from sys import argv
    if len(argv) < 2 or argv[1] == "-h":
        print usage
        return

    if 'TMP33' not in environ: passwd = raw_input('tmp33 password? ')
    else: passwd = environ['TMP33']

    blinktmp33 = 'BLINKTMP33' in environ
    for f in argv[1:]:
        uri = upload_file(f, passwd)
        print blinkto(uri) if blinktmp33 else uri


if __name__ == '__main__':
    main()

